{% extends "body.html" %}

{% block allcontent %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignments - eSchool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-light: #e0e7ff;
            --secondary-color: #3a0ca3;
            --accent-color: #4cc9f0;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --light-color: #f8fafc;
            --dark-color: #1e293b;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        

        /* Header Styles */
        .page-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .page-icon {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 2.5rem;
            backdrop-filter: blur(5px);
        }

        .page-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
            text-align: center;
        }

        .page-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            flex-shrink: 0;
        }

        .stat-info {
            flex: 1;
        }

        .stat-number {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray-500);
        }

        /* Tabs Navigation */
        .tabs {
            display: flex;
            background: white;
            border-radius: var(--border-radius-sm);
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            padding: 18px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            color: var(--gray-600);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 200px;
        }

        .tab-btn:hover {
            background: var(--gray-50);
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Filter Bar */
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
        }

        .filter-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .select-control {
            padding: 10px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
            background: white;
            cursor: pointer;
            min-width: 180px;
            transition: var(--transition);
        }

        .select-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Assignment Cards */
        .assignments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .assignment-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            border: 2px solid transparent;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .assignment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .assignment-card.pending {
            border-left: 4px solid var(--warning-color);
        }

        .assignment-card.in-progress {
            border-left: 4px solid var(--accent-color);
        }

        .assignment-card.completed {
            border-left: 4px solid var(--success-color);
        }

        .assignment-card.overdue {
            border-left: 4px solid var(--danger-color);
        }

        .assignment-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .assignment-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .assignment-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }

        .status-in-progress {
            background: rgba(76, 201, 240, 0.1);
            color: var(--accent-color);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .status-overdue {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-color);
        }

        .assignment-course {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .course-badge {
            padding: 4px 12px;
            background: var(--primary-light);
            color: var(--primary-color);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .assignment-description {
            color: var(--gray-600);
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .assignment-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-200);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .meta-item i {
            color: var(--gray-500);
        }

        .assignment-progress {
            margin-bottom: 20px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .progress-label {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .progress-percent {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .progress-bar {
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-pending {
            background: linear-gradient(90deg, var(--warning-color), #fbbf24);
        }

        .progress-in-progress {
            background: linear-gradient(90deg, var(--accent-color), #3abff8);
        }

        .progress-completed {
            background: linear-gradient(90deg, var(--success-color), #34d399);
        }

        .progress-overdue {
            background: linear-gradient(90deg, var(--danger-color), #f87171);
        }

        .assignment-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius-sm);
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-light);
        }

        .btn-success {
            background: transparent;
            color: var(--success-color);
            border: 2px solid var(--success-color);
        }

        .btn-success:hover {
            background-color: var(--success-color);
            color: white;
        }

        .btn-danger {
            background: transparent;
            color: var(--danger-color);
            border: 2px solid var(--danger-color);
        }

        .btn-danger:hover {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        /* Timeline View */
        .timeline-view {
            display: none;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--gray-200);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            border-left: 4px solid var(--warning-color);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -36px;
            top: 25px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            border: 3px solid var(--warning-color);
            z-index: 2;
        }

        .timeline-item.completed::before {
            border-color: var(--success-color);
        }

        .timeline-item.overdue::before {
            border-color: var(--danger-color);
        }

        .timeline-date {
            position: absolute;
            left: -120px;
            top: 20px;
            width: 80px;
            text-align: right;
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            margin-bottom: 40px;
        }

        .empty-icon {
            width: 100px;
            height: 100px;
            background: var(--gray-100);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 2.5rem;
            color: var(--gray-400);
        }

        .empty-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.8rem;
            color: var(--gray-600);
            margin-bottom: 15px;
        }

        .empty-text {
            color: var(--gray-500);
            max-width: 500px;
            margin: 0 auto 30px;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            color: var(--dark-color);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--gray-500);
            font-size: 1.2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-modal:hover {
            background: var(--gray-100);
            color: var(--danger-color);
        }

        .modal-body {
            padding: 25px;
        }

        /* Assignment Form */
        .assignment-form {
            display: grid;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.95rem;
        }

        .form-group .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            transition: var(--transition);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .file-upload {
            border: 2px dashed var(--gray-300);
            border-radius: var(--border-radius-sm);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload:hover {
            border-color: var(--primary-color);
            background: var(--gray-50);
        }

        .file-upload input {
            display: none;
        }

        .file-upload-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            color: var(--gray-600);
        }

        .file-upload-label i {
            font-size: 2rem;
            color: var(--primary-color);
        }

        /* Assignment Details */
        .assignment-details {
            display: grid;
            gap: 25px;
        }

        .detail-section {
            padding: 20px;
            background: var(--gray-50);
            border-radius: var(--border-radius);
        }

        .detail-section h4 {
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .requirements-list {
            list-style: none;
        }

        .requirements-list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .requirements-list li:last-child {
            border-bottom: none;
        }

        .requirements-list li i {
            color: var(--success-color);
        }

        /* Submission History */
        .submissions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .submission-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--gray-200);
        }

        .submission-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .submission-grade {
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .grade-a { background: #d1fae5; color: #065f46; }
        .grade-b { background: #fef3c7; color: #92400e; }
        .grade-c { background: #fde68a; color: #78350f; }
        .grade-d { background: #fecaca; color: #991b1b; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .assignments-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box, .select-control {
                width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .tab-btn {
                min-width: 150px;
            }
            
            .timeline-date {
                position: static;
                text-align: left;
                width: auto;
                margin-bottom: 10px;
            }
            
            .assignment-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 576px) {
            .page-header {
                padding: 30px 20px;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .stats-overview {
                grid-template-columns: 1fr;
            }
            
            .assignment-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .assignment-status {
                align-self: flex-start;
            }
        }

        /* Print Styles */
        @media print {
            .btn, .filter-bar, .tabs, .modal {
                display: none !important;
            }
            
            .assignment-card {
                break-inside: avoid;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="page-header">
            <div class="header-content">
                <div class="page-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <h1 class="page-title">Assignments</h1>
                <p class="page-subtitle">Track, manage, and submit your academic assignments in one place</p>
            </div>
        </header>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--warning-color), #fbbf24);">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number">4</div>
                    <div class="stat-label">Pending Assignments</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--accent-color), #3abff8);">
                    <i class="fas fa-spinner"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number">2</div>
                    <div class="stat-label">In Progress</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--success-color), #34d399);">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number">8</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, var(--danger-color), #f87171);">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="stat-info">
                    <div class="stat-number">1</div>
                    <div class="stat-label">Overdue</div>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('all')">
                <i class="fas fa-list"></i> All Assignments
            </button>
            <button class="tab-btn" onclick="switchTab('inprogress')">
                <i class="fas fa-spinner"></i> In Progress
            </button>
            <button class="tab-btn" onclick="switchTab('completed')">
                <i class="fas fa-check-circle"></i> Completed
            </button>
            <button class="tab-btn" onclick="switchTab('timeline')">
                <i class="fas fa-stream"></i> Timeline View
            </button>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-group">
                <div class="search-box">
                    <input type="text" id="searchAssignments" class="form-control" placeholder="Search assignments...">
                </div>
                <select id="courseFilter" class="select-control">
                    <option value="">All Courses</option>
                    <option value="math101">Mathematics 101</option>
                    <option value="physics201">Physics 201</option>
                    <option value="cs301">Computer Science 301</option>
                    <option value="english101">English Literature 101</option>
                </select>
                <select id="priorityFilter" class="select-control">
                    <option value="">All Priorities</option>
                    <option value="high">High Priority</option>
                    <option value="medium">Medium Priority</option>
                    <option value="low">Low Priority</option>
                </select>
                <select id="sortAssignments" class="select-control">
                    <option value="dueDate">Sort by Due Date</option>
                    <option value="recent">Most Recent</option>
                    <option value="priority">Priority</option>
                    <option value="course">Course</option>
                </select>
                <button class="btn btn-primary" onclick="openCreateModal()">
                    <i class="fas fa-plus"></i> New Assignment
                </button>
            </div>
        </div>

        <!-- All Assignments Tab -->
        <div id="all-tab" class="tab-content active">
            <div class="assignments-grid" id="assignmentsGrid">
                <!-- Assignment cards will be loaded here -->
            </div>
        </div>

        <!-- Pending Assignments Tab -->
        <div id="pending-tab" class="tab-content">
            <div class="assignments-grid" id="pendingGrid">
                <!-- Pending assignments will be loaded here -->
            </div>
        </div>

        <!-- In Progress Tab -->
        <div id="inprogress-tab" class="tab-content">
            <div class="assignments-grid" id="inProgressGrid">
                <!-- In progress assignments will be loaded here -->
            </div>
        </div>

        <!-- Completed Tab -->
        <div id="completed-tab" class="tab-content">
            <div class="assignments-grid" id="completedGrid">
                <!-- Completed assignments will be loaded here -->
            </div>
        </div>

        <!-- Timeline View Tab -->
        <div id="timeline-tab" class="tab-content timeline-view">
            <div class="timeline" id="timelineContainer">
                <!-- Timeline items will be loaded here -->
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-icon">
                <i class="fas fa-tasks"></i>
            </div>
            <h3 class="empty-title">No Assignments Found</h3>
            <p class="empty-text">No assignments match your current filters. Try adjusting your search criteria or create a new assignment.</p>
            <button class="btn btn-primary" onclick="openCreateModal()">
                <i class="fas fa-plus"></i> Create New Assignment
            </button>
        </div>
    </div>

    <!-- Create Assignment Modal -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Assignment</h3>
                <button class="close-modal" onclick="closeCreateModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form class="assignment-form" id="assignmentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="assignmentTitle">Assignment Title *</label>
                            <input type="text" id="assignmentTitle" class="form-control" placeholder="Enter assignment title" required>
                        </div>
                        <div class="form-group">
                            <label for="assignmentCourse">Course *</label>
                            <select id="assignmentCourse" class="form-control" required>
                                <option value="">Select Course</option>
                                <option value="math101">Mathematics 101</option>
                                <option value="physics201">Physics 201</option>
                                <option value="cs301">Computer Science 301</option>
                                <option value="english101">English Literature 101</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dueDate">Due Date *</label>
                            <input type="date" id="dueDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="priority">Priority</label>
                            <select id="priority" class="form-control">
                                <option value="high">High Priority</option>
                                <option value="medium" selected>Medium Priority</option>
                                <option value="low">Low Priority</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" class="form-control" placeholder="Describe the assignment requirements..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Attachments</label>
                        <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                            <input type="file" id="fileInput" multiple>
                            <div class="file-upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Click to upload files or drag and drop</span>
                                <small>PDF, DOC, PPT, JPG, PNG (Max 10MB each)</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">
                            <i class="fas fa-save"></i> Create Assignment
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Assignment Details Modal -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="detailsTitle">Assignment Details</h3>
                <button class="close-modal" onclick="closeDetailsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="assignment-details" id="assignmentDetails">
                    <!-- Details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // =========================
        // DATA & STATE
        // =========================
        let assignments = JSON.parse(localStorage.getItem('eschool_assignments')) || [];
        let currentUser = "{{ firstname }} {{ lastname }}" || "Student";
        
        // Sample data if empty
        if (assignments.length === 0) {
            assignments = [
                {
                    id: 1,
                    title: "Calculus Problem Set",
                    course: "math101",
                    description: "Complete problems from Chapter 3.1-3.5 on limits and continuity. Show all work for full credit.",
                    dueDate: "2023-10-20",
                    status: "pending",
                    priority: "high",
                    progress: 30,
                    instructor: "Dr. Smith",
                    points: 100,
                    attachments: ["problem_set.pdf", "instructions.docx"],
                    requirements: ["Show all work", "Use proper notation", "Submit as PDF"],
                    createdAt: "2023-10-10",
                    submissions: []
                },
                {
                    id: 2,
                    title: "Physics Lab Report",
                    course: "physics201",
                    description: "Write a comprehensive report on the thermodynamics experiment conducted in Lab 5.",
                    dueDate: "2023-10-18",
                    status: "in-progress",
                    priority: "high",
                    progress: 60,
                    instructor: "Prof. Johnson",
                    points: 150,
                    attachments: ["lab_guidelines.pdf"],
                    requirements: ["Include data tables", "Add graphs", "Discuss results"],
                    createdAt: "2023-10-05",
                    submissions: []
                },
                {
                    id: 3,
                    title: "Python Programming Project",
                    course: "cs301",
                    description: "Implement a sorting algorithm visualizer using Python and PyGame.",
                    dueDate: "2023-10-25",
                    status: "pending",
                    priority: "medium",
                    progress: 10,
                    instructor: "Dr. Williams",
                    points: 200,
                    attachments: ["project_rubric.pdf", "starter_code.zip"],
                    requirements: ["Use PyGame", "Include 4 algorithms", "Add user controls"],
                    createdAt: "2023-10-12",
                    submissions: []
                },
                {
                    id: 4,
                    title: "Literature Analysis Essay",
                    course: "english101",
                    description: "Analyze the themes in 'Pride and Prejudice' and their relevance today.",
                    dueDate: "2023-10-15",
                    status: "overdue",
                    priority: "high",
                    progress: 90,
                    instructor: "Dr. Brown",
                    points: 100,
                    attachments: ["essay_rubric.pdf"],
                    requirements: ["1500-2000 words", "MLA format", "Include citations"],
                    createdAt: "2023-10-01",
                    submissions: []
                },
                {
                    id: 5,
                    title: "Research Paper Outline",
                    course: "english101",
                    description: "Create a detailed outline for your final research paper.",
                    dueDate: "2023-10-22",
                    status: "completed",
                    priority: "medium",
                    progress: 100,
                    instructor: "Dr. Brown",
                    points: 50,
                    attachments: [],
                    requirements: ["Thesis statement", "Main points", "Sources"],
                    createdAt: "2023-10-08",
                    submissions: [
                        {
                            date: "2023-10-21",
                            file: "outline.docx",
                            grade: "A",
                            feedback: "Excellent outline with clear structure."
                        }
                    ]
                },
                {
                    id: 6,
                    title: "Math Quiz Review",
                    course: "math101",
                    description: "Complete practice problems for the upcoming quiz on derivatives.",
                    dueDate: "2023-10-19",
                    status: "completed",
                    priority: "low",
                    progress: 100,
                    instructor: "Dr. Smith",
                    points: 30,
                    attachments: ["practice_problems.pdf"],
                    requirements: ["All problems", "Show work", "Time yourself"],
                    createdAt: "2023-10-10",
                    submissions: [
                        {
                            date: "2023-10-18",
                            file: "review_completed.pdf",
                            grade: "B+",
                            feedback: "Good work, watch your signs."
                        }
                    ]
                }
            ];
            saveAssignments();
        }

        const courseData = {
            math101: { name: "Mathematics 101", color: "#4361ee", icon: "fa-calculator" },
            physics201: { name: "Physics 201", color: "#ff6b6b", icon: "fa-atom" },
            cs301: { name: "Computer Science 301", color: "#1dd1a1", icon: "fa-laptop-code" },
            english101: { name: "English Literature 101", color: "#feca57", icon: "fa-book-open" }
        };

        // =========================
        // INITIALIZATION
        // =========================
        document.addEventListener('DOMContentLoaded', () => {
            loadAssignments();
            updateStats();
            setupEventListeners();
        });

        // =========================
        // DATA MANAGEMENT
        // =========================
        function saveAssignments() {
            localStorage.setItem('eschool_assignments', JSON.stringify(assignments));
        }

        function updateStats() {
            const pending = assignments.filter(a => a.status === 'pending').length;
            const inProgress = assignments.filter(a => a.status === 'in-progress').length;
            const completed = assignments.filter(a => a.status === 'completed').length;
            const overdue = assignments.filter(a => a.status === 'overdue').length;

            document.querySelectorAll('.stat-number')[0].textContent = pending;
            document.querySelectorAll('.stat-number')[1].textContent = inProgress;
            document.querySelectorAll('.stat-number')[2].textContent = completed;
            document.querySelectorAll('.stat-number')[3].textContent = overdue;
        }

        // =========================
        // ASSIGNMENT LOADING
        // =========================
        function loadAssignments() {
            const filtered = getFilteredAssignments('all');
            renderAssignmentsGrid(filtered, 'assignmentsGrid');
            loadFilteredViews();
        }

        function getFilteredAssignments(status) {
            const searchTerm = document.getElementById('searchAssignments').value.toLowerCase();
            const courseFilter = document.getElementById('courseFilter').value;
            const priorityFilter = document.getElementById('priorityFilter').value;
            const sortBy = document.getElementById('sortAssignments').value;

            let filtered = assignments.filter(assignment => {
                if (status !== 'all' && assignment.status !== status) return false;
                if (courseFilter && assignment.course !== courseFilter) return false;
                if (priorityFilter && assignment.priority !== priorityFilter) return false;
                if (searchTerm && !assignment.title.toLowerCase().includes(searchTerm) &&
                    !assignment.description.toLowerCase().includes(searchTerm)) return false;
                return true;
            });

            // Sort assignments
            filtered.sort((a, b) => {
                switch(sortBy) {
                    case 'dueDate':
                        return new Date(a.dueDate) - new Date(b.dueDate);
                    case 'recent':
                        return new Date(b.createdAt) - new Date(a.createdAt);
                    case 'priority':
                        const priorityOrder = { high: 0, medium: 1, low: 2 };
                        return priorityOrder[a.priority] - priorityOrder[b.priority];
                    case 'course':
                        return a.course.localeCompare(b.course);
                    default:
                        return new Date(a.dueDate) - new Date(b.dueDate);
                }
            });

            return filtered;
        }

        function renderAssignmentsGrid(assignmentsList, containerId) {
            const container = document.getElementById(containerId);
            
            if (assignmentsList.length === 0) {
                container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1; margin: 0;"><p>No assignments found.</p></div>';
                return;
            }

            container.innerHTML = assignmentsList.map(assignment => createAssignmentCard(assignment)).join('');
        }

        function createAssignmentCard(assignment) {
            const course = courseData[assignment.course];
            const dueDate = new Date(assignment.dueDate);
            const now = new Date();
            const timeDiff = dueDate - now;
            const daysLeft = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
            
            let dueText = '';
            if (daysLeft < 0) {
                dueText = `${Math.abs(daysLeft)} days overdue`;
            } else if (daysLeft === 0) {
                dueText = 'Due today';
            } else if (daysLeft === 1) {
                dueText = 'Due tomorrow';
            } else {
                dueText = `Due in ${daysLeft} days`;
            }

            return `
                <div class="assignment-card ${assignment.status}" data-id="${assignment.id}">
                    <div class="assignment-header">
                        <div>
                            <h3 class="assignment-title">${assignment.title}</h3>
                            <div class="assignment-course">
                                <i class="fas ${course.icon}" style="color: ${course.color}"></i>
                                <span>${course.name}</span>
                                <span class="course-badge">${assignment.points} points</span>
                            </div>
                        </div>
                        <span class="assignment-status status-${assignment.status}">
                            ${assignment.status.replace('-', ' ')}
                        </span>
                    </div>
                    
                    <p class="assignment-description">${assignment.description.substring(0, 120)}${assignment.description.length > 120 ? '...' : ''}</p>
                    
                    <div class="assignment-meta">
                        <div class="meta-item">
                            <i class="fas fa-calendar-alt"></i>
                            <span>${dueText}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-user-graduate"></i>
                            <span>${assignment.instructor}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-paperclip"></i>
                            <span>${assignment.attachments.length} files</span>
                        </div>
                    </div>
                    
                    <div class="assignment-progress">
                        <div class="progress-header">
                            <span class="progress-label">Progress</span>
                            <span class="progress-percent">${assignment.progress}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill progress-${assignment.status}" style="width: ${assignment.progress}%"></div>
                        </div>
                    </div>
                    
                    <div class="assignment-actions">
                        <button class="btn btn-primary btn-small" onclick="viewAssignmentDetails(${assignment.id})">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                        <button class="btn btn-outline btn-small" onclick="startAssignment(${assignment.id})">
                            <i class="fas fa-play"></i> Start
                        </button>
                        <button class="btn btn-success btn-small" onclick="submitAssignment(${assignment.id})">
                            <i class="fas fa-upload"></i> Submit
                        </button>
                        ${assignment.status === 'completed' ? `
                        <button class="btn btn-outline btn-small" onclick="viewSubmission(${assignment.id})">
                            <i class="fas fa-file-alt"></i> Submission
                        </button>` : ''}
                    </div>
                </div>
            `;
        }

        function loadFilteredViews() {
            ['pending', 'inprogress', 'completed'].forEach(status => {
                const filtered = getFilteredAssignments(status);
                renderAssignmentsGrid(filtered, `${status}Grid`);
            });
            
            loadTimelineView();
        }

        function loadTimelineView() {
            const timeline = document.getElementById('timelineContainer');
            const sortedAssignments = [...assignments].sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
            
            timeline.innerHTML = sortedAssignments.map(assignment => {
                const course = courseData[assignment.course];
                const dueDate = new Date(assignment.dueDate);
                const dateStr = dueDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                
                return `
                    <div class="timeline-item ${assignment.status}">
                        <div class="timeline-date">${dateStr}</div>
                        <div class="assignment-card ${assignment.status}" style="margin: 0; box-shadow: none; border: 1px solid var(--gray-200);">
                            <div class="assignment-header">
                                <h3 class="assignment-title">${assignment.title}</h3>
                                <span class="assignment-status status-${assignment.status}">
                                    ${assignment.status.replace('-', ' ')}
                                </span>
                            </div>
                            <div class="assignment-course">
                                <i class="fas ${course.icon}" style="color: ${course.color}"></i>
                                <span>${course.name}</span>
                            </div>
                            <div class="assignment-actions">
                                <button class="btn btn-primary btn-small" onclick="viewAssignmentDetails(${assignment.id})">
                                    View Details
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // =========================
        // TAB MANAGEMENT
        // =========================
        function switchTab(tabName) {
            // Update tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Update empty state visibility
            updateEmptyState();
        }

        function updateEmptyState() {
            const activeTab = document.querySelector('.tab-content.active');
            const hasContent = activeTab.querySelector('.assignment-card, .timeline-item') !== null;
            document.getElementById('emptyState').style.display = hasContent ? 'none' : 'block';
        }

        // =========================
        // ASSIGNMENT ACTIONS
        // =========================
        function viewAssignmentDetails(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment) return;
            
            const course = courseData[assignment.course];
            const dueDate = new Date(assignment.dueDate);
            const formattedDate = dueDate.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            document.getElementById('detailsTitle').textContent = assignment.title;
            
            document.getElementById('assignmentDetails').innerHTML = `
                <div class="detail-section">
                    <h4><i class="fas fa-info-circle"></i> Assignment Information</h4>
                    <p><strong>Course:</strong> ${course.name}</p>
                    <p><strong>Instructor:</strong> ${assignment.instructor}</p>
                    <p><strong>Due Date:</strong> ${formattedDate}</p>
                    <p><strong>Points:</strong> ${assignment.points}</p>
                    <p><strong>Status:</strong> <span class="assignment-status status-${assignment.status}">${assignment.status.replace('-', ' ')}</span></p>
                    <p><strong>Priority:</strong> ${assignment.priority}</p>
                </div>
                
                <div class="detail-section">
                    <h4><i class="fas fa-align-left"></i> Description</h4>
                    <p>${assignment.description}</p>
                </div>
                
                <div class="detail-section">
                    <h4><i class="fas fa-list-check"></i> Requirements</h4>
                    <ul class="requirements-list">
                        ${assignment.requirements.map(req => `<li><i class="fas fa-check"></i> ${req}</li>`).join('')}
                    </ul>
                </div>
                
                ${assignment.attachments.length > 0 ? `
                <div class="detail-section">
                    <h4><i class="fas fa-paperclip"></i> Attachments (${assignment.attachments.length})</h4>
                    <div class="assignment-actions">
                        ${assignment.attachments.map(file => `
                            <button class="btn btn-outline btn-small" onclick="downloadFile('${file}')">
                                <i class="fas fa-download"></i> ${file}
                            </button>
                        `).join('')}
                    </div>
                </div>` : ''}
                
                ${assignment.submissions.length > 0 ? `
                <div class="detail-section">
                    <h4><i class="fas fa-history"></i> Submission History</h4>
                    <div class="submissions-list">
                        ${assignment.submissions.map(sub => `
                            <div class="submission-item">
                                <div class="submission-info">
                                    <div>
                                        <strong>Submitted: ${new Date(sub.date).toLocaleDateString()}</strong><br>
                                        <small>${sub.file}</small>
                                    </div>
                                    ${sub.grade ? `<span class="submission-grade grade-${sub.grade.toLowerCase()}">${sub.grade}</span>` : ''}
                                </div>
                                <button class="btn btn-outline btn-small" onclick="viewFeedback(${assignment.id})">
                                    <i class="fas fa-comment"></i> Feedback
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>` : ''}
                
                <div class="assignment-actions" style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="startAssignment(${assignment.id})">
                        <i class="fas fa-play"></i> Start Assignment
                    </button>
                    <button class="btn btn-success" onclick="submitAssignment(${assignment.id})">
                        <i class="fas fa-upload"></i> Submit Work
                    </button>
                    <button class="btn btn-outline" onclick="closeDetailsModal()">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            `;
            
            document.getElementById('detailsModal').style.display = 'flex';
        }

        function startAssignment(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment) return;
            
            if (assignment.status === 'pending') {
                assignment.status = 'in-progress';
                saveAssignments();
                loadAssignments();
                updateStats();
            }
            
            alert(`Starting "${assignment.title}"\n\nA workspace will open where you can work on this assignment.`);
        }

        function submitAssignment(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment) return;
            
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.multiple = true;
            
            fileInput.onchange = (e) => {
                const files = Array.from(e.target.files);
                if (files.length === 0) return;
                
                // Update assignment status
                assignment.status = 'completed';
                assignment.progress = 100;
                assignment.submissions.push({
                    date: new Date().toISOString().split('T')[0],
                    file: files.map(f => f.name).join(', '),
                    grade: null,
                    feedback: null
                });
                
                saveAssignments();
                loadAssignments();
                updateStats();
                closeDetailsModal();
                
                alert(`Successfully submitted "${assignment.title}"!\n\nFiles: ${files.map(f => f.name).join(', ')}\n\nYour submission is now pending review.`);
            };
            
            fileInput.click();
        }

        function viewSubmission(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment || assignment.submissions.length === 0) return;
            
            const latest = assignment.submissions[assignment.submissions.length - 1];
            alert(`Latest Submission:\n\nDate: ${latest.date}\nFile: ${latest.file}\nGrade: ${latest.grade || 'Not graded yet'}\nFeedback: ${latest.feedback || 'No feedback yet'}`);
        }

        function viewFeedback(id) {
            const assignment = assignments.find(a => a.id === id);
            if (!assignment) return;
            
            alert(`Instructor Feedback for "${assignment.title}":\n\n${assignment.submissions[0]?.feedback || 'No feedback available yet.'}`);
        }

        function downloadFile(filename) {
            alert(`Downloading ${filename}...\n\n(In a real application, this would download the file)`);
        }

        // =========================
        // MODAL FUNCTIONS
        // =========================
        function openCreateModal() {
            document.getElementById('createModal').style.display = 'flex';
            document.getElementById('assignmentTitle').focus();
        }

        function closeCreateModal() {
            document.getElementById('createModal').style.display = 'none';
            document.getElementById('assignmentForm').reset();
        }

        function closeDetailsModal() {
            document.getElementById('detailsModal').style.display = 'none';
        }

        // =========================
        // FORM HANDLING
        // =========================
        document.getElementById('assignmentForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const newAssignment = {
                id: Date.now(),
                title: document.getElementById('assignmentTitle').value,
                course: document.getElementById('assignmentCourse').value,
                description: document.getElementById('description').value || 'No description provided.',
                dueDate: document.getElementById('dueDate').value,
                priority: document.getElementById('priority').value,
                status: 'pending',
                progress: 0,
                instructor: courseData[document.getElementById('assignmentCourse').value]?.name.split(' ')[0] || 'Instructor',
                points: 100,
                attachments: [],
                requirements: [
                    'Complete all tasks',
                    'Follow instructions carefully',
                    'Submit before deadline'
                ],
                createdAt: new Date().toISOString().split('T')[0],
                submissions: []
            };
            
            assignments.unshift(newAssignment);
            saveAssignments();
            loadAssignments();
            updateStats();
            closeCreateModal();
            
            alert(`Assignment "${newAssignment.title}" created successfully!`);
        });

        // =========================
        // EVENT LISTENERS
        // =========================
        function setupEventListeners() {
            // Search and filter listeners
            document.getElementById('searchAssignments').addEventListener('input', loadAssignments);
            document.getElementById('courseFilter').addEventListener('change', loadAssignments);
            document.getElementById('priorityFilter').addEventListener('change', loadAssignments);
            document.getElementById('sortAssignments').addEventListener('change', loadAssignments);
            
            // Close modals on ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeCreateModal();
                    closeDetailsModal();
                }
            });
            
            // Close modals on outside click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            });
        }

        // =========================
        // UTILITY FUNCTIONS
        // =========================
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
            });
        }

        function getTimeRemaining(dueDate) {
            const now = new Date();
            const due = new Date(dueDate);
            const diff = due - now;
            
            if (diff < 0) return 'Overdue';
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            if (days === 0) return 'Due today';
            if (days === 1) return 'Due tomorrow';
            return `Due in ${days} days`;
        }
    </script>
</body>
</html>
{% endblock %}